(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b830362"],{"341c":function(e,t,s){"use strict";var a=s("b880"),i=s.n(a);i.a},b880:function(e,t,s){},cd45:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table"},[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户授权")])],1)],1),s("div",{staticClass:"container"},[s("div",{staticClass:"handle-box"},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"主机"}},[s("el-select",{staticStyle:{width:"500px"},attrs:{"value-key":"hostname",filterable:"",clearable:"",multiple:"",placeholder:"请选择主机"},model:{value:e.n_value,callback:function(t){e.n_value=t},expression:"n_value"}},e._l(e.assets,function(e){return s("el-option",{key:e.id,attrs:{label:e.hostname,value:e}})}),1)],1),s("el-form-item",{attrs:{label:"角色"}},[s("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择角色"},on:{change:e.getChangedTemplate},model:{value:e.t_value,callback:function(t){e.t_value=t},expression:"t_value"}},e._l(e.options,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e}})}),1)],1),s("el-form-item",{attrs:{label:"用户"}},[s("el-select",{attrs:{"value-key":"username",multiple:"",filterable:"",clearable:"",placeholder:"请选择被授权用户"},model:{value:e.u_value,callback:function(t){e.u_value=t},expression:"u_value"}},e._l(e.users,function(e){return s("el-option",{key:e.id,attrs:{label:e.username,value:e}})}),1)],1)],1)],1),s("div",{staticClass:"but"},[s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("授 权")])],1)])])])},i=[],l=(s("7f7f"),s("96cf"),s("3b8d")),n=s("cebc"),r=s("2f62"),o={name:"basetable",data:function(){return{url:"./vuetable.json",tableData:[],cur_page:1,page_size:50,page_total:1,users:[],multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,addVisible:!1,editVisible:!1,delVisible:!1,assets:[],templates:[],form:{id:0,tags:[],grantor:"",users:[],template_id:""},username:"",idx:-1,options:[{id:1,name:"root"},{id:2,name:"work"}],value:"",nodes:[],instances:[],n_value:[],t_value:"",t_template_id:"",u_value:[]}},created:function(){this.getData()},computed:{data:function(){return{data:this.$store.state.users.data}}},methods:Object(n["a"])({},Object(r["b"])(["getUsers","getAllAssets","tempGrant"]),{handleCurrentChange:function(e){this.cur_page=e,this.getData()},getData:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.getUsers({page:this.cur_page,pageSize:2e3});case 4:return e.next=6,this.getAllAssets();case 6:this.assets=this.$store.state.all_assets,console.log("this.assets:",this.assets),this.users=this.$store.state.users.data;case 9:return e.prev=9,this.loading=!1,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,,9,12]])}));function t(){return e.apply(this,arguments)}return t}(),loadData:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.getUsers({page:this.cur_page,pageSize:this.page_size});case 4:return e.prev=4,this.loading=!1,e.finish(4);case 7:case"end":return e.stop()}},e,this,[[1,,4,7]])}));function t(){return e.apply(this,arguments)}return t}(),search:function(){this.is_search=!0},formatter:function(e,t){return e.status},filterTag:function(e,t){return t.tag===e},handlerUserAdd:function(){this.addVisible=!0},handleEdit:function(e,t){this.idx=e;var s=this.tableData[e];this.form={id:s.id,username:s.username,protocol:s.protocol,is_active:s.is_active,password:"",public_key:""},s.is_active?this.value="启用":this.value="禁用",this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.delVisible=!0},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var s=0;s<e;s++)t+=this.multipleSelection[s].name+" ";this.$message.error("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveEdit:function(){this.form.password=this.tableData[this.idx].password,this.form.public_key=this.tableData[this.idx].public_key,this.$set(this.tableData,this.idx,this.form),this.updateUser(this.tableData[this.idx])},saveAdd:function(){console.log("users:",this.data.u_value);var e={id:0,hosts:this.n_value,grantor:this.$store.state.user.username,users:this.u_value,role:this.t_value};this.tempGrant(e),this.getData()},deleteRow:function(){var e=this.tableData[this.idx].id;this.tableData.splice(this.idx,1),this.deleteUser(e),this.$message.success("删除成功"),this.delVisible=!1},getChangedNode:function(e){console.log("node:"+e.tag_id),this.form.tag=e.business,this.form.tag_id=e.tag_id,this.n_value=e.business},getChangedTemplate:function(e){console.log("template:"+e.id),this.t_template_id=e.id,this.t_value=e.name},getChangedUser:function(e){console.log("user:",e),this.form.user_id=e.id,this.u_value=e.username}})},u=o,c=(s("341c"),s("2877")),h=Object(c["a"])(u,a,i,!1,null,"6f13730a",null);t["default"]=h.exports}}]);