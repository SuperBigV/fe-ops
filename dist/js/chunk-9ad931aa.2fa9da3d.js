(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ad931aa"],{"71b7":function(e,t,a){"use strict";var s=a("ea6d"),l=a.n(s);l.a},9299:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"用户授权",name:"first"}},[a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户授权")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"产品线"}},[a("el-select",{staticStyle:{width:"500px"},attrs:{"value-key":"business",filterable:"",clearable:"",multiple:"",placeholder:"请选择节点"},model:{value:e.n_value,callback:function(t){e.n_value=t},expression:"n_value"}},e._l(e.nodes,function(e){return a("el-option",{key:e.tag_id,attrs:{label:e.business,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"模板"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择模板"},on:{change:e.getChangedTemplate},model:{value:e.t_value,callback:function(t){e.t_value=t},expression:"t_value"}},e._l(e.templates,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"用户"}},[a("el-select",{attrs:{"value-key":"username",multiple:"",filterable:"",clearable:"",placeholder:"请选择被授权用户"},model:{value:e.u_value,callback:function(t){e.u_value=t},expression:"u_value"}},e._l(e.users,function(e){return a("el-option",{key:e.id,attrs:{label:e.username,value:e}})}),1)],1)],1)],1),a("div",{staticClass:"but"},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("授 权")])],1)])])])]),a("el-tab-pane",{attrs:{label:"临时权限",name:"second"}},[a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户授权")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"主机"}},[a("el-select",{staticStyle:{width:"500px"},attrs:{"value-key":"hostname",filterable:"",clearable:"",multiple:"",placeholder:"请选择主机"},model:{value:e.n1_value,callback:function(t){e.n1_value=t},expression:"n1_value"}},e._l(e.assets,function(e){return a("el-option",{key:e.id,attrs:{label:e.hostname,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择角色"},on:{change:e.getChangedTemplate},model:{value:e.t1_value,callback:function(t){e.t1_value=t},expression:"t1_value"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"用户"}},[a("el-select",{attrs:{"value-key":"username",multiple:"",filterable:"",clearable:"",placeholder:"请选择被授权用户"},model:{value:e.u1_value,callback:function(t){e.u1_value=t},expression:"u1_value"}},e._l(e.users,function(e){return a("el-option",{key:e.id,attrs:{label:e.username,value:e}})}),1)],1)],1)],1),a("div",{staticClass:"but"},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveTempPriv}},[e._v("授 权")])],1)])])])])],1)},l=[],i=(a("7f7f"),a("96cf"),a("3b8d")),r=a("cebc"),n=a("2f62"),o={name:"basetable",data:function(){return{url:"./vuetable.json",tableData:[],cur_page:1,page_size:50,page_total:1,users:[],multipleSelection:[],select_cate:"",select_word:"",del_list:[],activeName:"first",is_search:!1,addVisible:!1,editVisible:!1,delVisible:!1,templates:[],assets:[],form:{id:0,tags:[],grantor:"",users:[],template_id:""},username:"",idx:-1,options:[{id:1,name:"root"},{id:2,name:"work"}],value:"",nodes:[],instances:[],n_value:[],t_value:"",t_template_id:"",u_value:[],n1_value:[],t1_value:"",t1_template_id:"",u1_value:[]}},created:function(){this.getData()},computed:{data:function(){return{data:this.$store.state.users.data}}},methods:Object(r["a"])({},Object(n["b"])(["getUsers","updateUser","deleteUser","addUser","getNodes","getTemplates","privUser","getAllAssets","tempGrant"]),{handleCurrentChange:function(e){this.cur_page=e,this.getData()},getData:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.getNodes();case 4:return e.next=6,this.getTemplates();case 6:return e.next=8,this.getUsers({page:this.cur_page,pageSize:2e3});case 8:return e.next=10,this.getAllAssets();case 10:this.assets=this.$store.state.all_assets,this.form.grantor=this.$store.state.user.username,this.users=this.$store.state.users.data,this.tableData=this.$store.state.users.data,this.nodes=this.$store.state.nodes,this.templates=this.$store.state.templates.data;case 14:return e.prev=14,this.loading=!1,e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,,14,17]])}));function t(){return e.apply(this,arguments)}return t}(),loadData:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.getUsers({page:this.cur_page,pageSize:this.page_size});case 4:return e.prev=4,this.loading=!1,e.finish(4);case 7:case"end":return e.stop()}},e,this,[[1,,4,7]])}));function t(){return e.apply(this,arguments)}return t}(),search:function(){this.is_search=!0},formatter:function(e,t){return e.status},filterTag:function(e,t){return t.tag===e},handlerUserAdd:function(){this.addVisible=!0},handleEdit:function(e,t){this.idx=e;var a=this.tableData[e];this.form={id:a.id,username:a.username,protocol:a.protocol,is_active:a.is_active,password:"",public_key:""},a.is_active?this.value="启用":this.value="禁用",this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.delVisible=!0},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var a=0;a<e;a++)t+=this.multipleSelection[a].name+" ";this.$message.error("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveEdit:function(){this.form.password=this.tableData[this.idx].password,this.form.public_key=this.tableData[this.idx].public_key,this.$set(this.tableData,this.idx,this.form),this.updateUser(this.tableData[this.idx])},saveAdd:function(){console.log("users:",this.data.u_value);var e={id:0,tags:this.n_value,grantor:this.$store.state.user.username,users:this.u_value,template_id:this.t_template_id};this.privUser(e),this.getData()},saveTempPriv:function(){console.log("users:",this.data.u_value);var e={id:0,hosts:this.n_value,grantor:this.$store.state.user.username,users:this.u_value,role:this.t_value};this.tempGrant(e),this.getData()},deleteRow:function(){var e=this.tableData[this.idx].id;this.tableData.splice(this.idx,1),this.deleteUser(e),this.$message.success("删除成功"),this.delVisible=!1},getChangedNode:function(e){console.log("node:"+e.tag_id),this.form.tag=e.business,this.form.tag_id=e.tag_id,this.n_value=e.business},getChangedTemplate:function(e){console.log("template:"+e.id),this.t_template_id=e.id,this.t_value=e.name},getChangedUser:function(e){console.log("user:",e),this.form.user_id=e.id,this.u_value=e.username}})},u=o,c=(a("71b7"),a("2877")),d=Object(c["a"])(u,s,l,!1,null,"6bac80bb",null);t["default"]=d.exports},ea6d:function(e,t,a){}}]);